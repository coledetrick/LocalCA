Install OpenSSL
make directory for cert

**Generates a new RSA private key and saves it to myCA.key**
openssl genrsa -des3 -out myCA.key 2048
genrsa — Generate an RSA private key.
-des3 — Encrypt the key with Triple-DES, so you'll be prompted for a passphrase.
-out myCA.key — Write the key to this file.
2048 — Key size in bits 

Create PEM passphrase.
- Password to unencrypt PEM file that protects the private key inside the PEM file.


openssl req -x509 -new -nodes -key myCA.key -sha256 -days 1825 -out myCA.pem
- creates a self-signed certificate as myCA.pem
- req
Use OpenSSL’s certificate request and certificate creation tool.
-x509
Output a self-signed X.509 certificate instead of a certificate signing request (CSR).
-new
Indicate that a new certificate is being created.
-nodes
This flag suppresses encryption prompts.
-key myCA.key
Use this existing private key to sign the certificate.
-sha256
Sign the certificate using the SHA-256 hashing algorithm.
-days 1825
Make the certificate valid for 30 days
-out myCA.pem
Save the final certificate to this file.


Fill in all the information.

copy file here as .crt
sudo cp ~/certs/myCA.pem /usr/local/share/ca-certificates/myCA.crt
- This copies your .pem file to the system’s trusted certificate directory, renaming it to myCA.crt as it's copied.

update certs now that you added your cert to the directory.
sudo update-ca-certificates

Now for generating cert for my local nginx web server.

# generates a 2048-bit RSA server key to be used as the cert for my nginx web server and to be signed by my own CA.
openssl genrsa -out myapp.local.key 2048

create file named, csr_myapp_local.cnf
- This fills in the X.509 subject fields automatically

[ req ]
default_bits       = 2048
prompt             = no
default_md         = sha256
req_extensions     = req_ext
distinguished_name = dn

[ dn ]
C  = US
ST = SomeState
L  = SomeCity
O  = My Lab
OU = Dev
CN = myapp.local

[ req_ext ]
subjectAltName = @alt_names

[ alt_names ]
DNS.1 = myapp.local

Then create the actual CSR
openssl req -new -key myapp.local.key -out myapp.local.csr -config csr_myapp_local.cnf



Sign your CSR with your CA, 
openssl x509 -req -in myapp.local.csr -CA myCA.pem -CAkey myCA.key -CAcreateserial -out detrick.test.crt -days 825 -sha256 -extfile csr_myapp_local.cnf -extensions req_ext

openssl x509
Use OpenSSL’s X.509 certificate tool (for creating, signing, displaying certificates).
-req
Tell OpenSSL that you're signing a Certificate Signing Request (CSR).
-in myapp.local.csr
This is the CSR being signed.
It contains:
the public key,
the subject information (CN, SANs, etc.),
and is signed using its private key.
-CA myCA.pem
The CA certificate used to sign the new certificate.
-CAkey myCA.key
The CA’s private key used to actually perform the digital signature.
-CAcreateserial
If a file like myCA.srl does not exist, create it.
This file tracks certificate serial numbers so each certificate gets a unique serial.
-out detrick.test.crt
This is the final signed certificate you’re generating.
-days 825
The new certificate is valid for 825 days (the current maximum recommended lifetime for public TLS certificates).
-sha256
Use the SHA-256 hashing algorithm for the signature.
-extfile detrick.test.ext
Load certificate extensions from this file.


sudo mkdir -p /etc/nginx/ssl

# adjust paths if your files are elsewhere
sudo cp myapp.key /etc/nginx/ssl/
sudo cp myapp.crt /etc/nginx/ssl/
sudo cp myCA.pem  /etc/nginx/ssl/


cd /etc/nginx/ssl
sudo chown root:root myapp.key myapp.crt myCA.pem
sudo chmod 600 myapp.key        # key is sensitive
sudo chmod 644 myapp.crt myCA.pem


cd /etc/nginx/ssl
sudo bash -c 'cat myapp.crt myCA.pem > myapp.fullchain.crt'

server {
    listen 443 ssl;
    server_name detrick.test;   # or whatever hostname is in your cert's SAN

    ssl_certificate     /etc/nginx/ssl/myapp.fullchain.crt;
    ssl_certificate_key /etc/nginx/ssl/myapp.key;

    ssl_protocols       TLSv1.2 TLSv1.3;
    ssl_ciphers         HIGH:!aNULL:!MD5;

    root /var/www/myapp;
    index index.html index.htm;

    location / {
        try_files $uri $uri/ =404;
    }
}

# Optional HTTP → HTTPS redirect
server {
    listen 80;
    server_name detrick.test;
    return 301 https://$host$request_uri;
}

sudo nginx -t
sudo systemctl reload nginx

sudo nano /etc/hosts
127.0.0.1 = myapp.local #your SAN

for firefox you must go to 
Firefox → Settings -> search for certificates -> Authorities -> Import -> select your .pem file.

restart your browser

Hello from HTTPS!


